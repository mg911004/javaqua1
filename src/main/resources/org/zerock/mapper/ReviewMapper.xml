<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.prg//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.zerock.mapper.ReviewMapper">
	<insert id="write">
		insert into review(rv_num, pd_num, user_id, content)
	 	values(REVIEW_SEQ.NEXTVAL,#{pd_num},#{user_id}, #{content})
	</insert>
	<update id="modify">
		update review set content=#{content} where pd_num=#{pd_num} and user_id=#{user_id}
	</update>
	
	<delete id="delete">
		delete review where pd_num=#{pd_num} and user_id=#{user_id}
	</delete>
	
	<select id="review_list" resultType="org.zerock.domain.ReviewVO">	
		<![CDATA[ SELECT * FROM ( 
	        SELECT A.*, 
	        ROWNUM AS RNUM FROM (
	            SELECT * FROM review WHERE pd_num=#{pd_num} order by writedate desc
	        ) A
        ) WHERE RNUM >= #{pdto.startNum} AND RNUM <= #{pdto.endNum} ]]>
	</select>

	<select id="review_cnt" resultType="int">
		select count(*) from review where pd_num=#{pd_num}
	</select>
	
	<select id="mywrite" resultType="org.zerock.domain.ReviewVO">
		select * from review where user_id=#{user_id} and pd_num=#{pd_num}
	</select>
</mapper>